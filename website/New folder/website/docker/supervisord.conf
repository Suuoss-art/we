[supervisord]
nodaemon=true
user=root
logfile=/var/log/supervisor/supervisord.log
pidfile=/var/run/supervisord.pid
childlogdir=/var/log/supervisor

[unix_http_server]
file=/var/run/supervisor.sock
chmod=0700

[supervisorctl]
serverurl=unix:///var/run/supervisor.sock

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[program:nginx]
command=/usr/sbin/nginx -g "daemon off;"
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/nginx.err.log
stdout_logfile=/var/log/supervisor/nginx.out.log
user=root

[program:php-fpm]
command=/usr/local/sbin/php-fpm --nodaemonize
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/php-fpm.err.log
stdout_logfile=/var/log/supervisor/php-fpm.out.log
user=root

[program:monitoring]
command=/usr/bin/python3 /app/monitoring/main.py
directory=/app/monitoring
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/monitoring.err.log
stdout_logfile=/var/log/supervisor/monitoring.out.log
user=root
environment=PYTHONPATH="/app/monitoring"

[program:ip-rotation]
command=/usr/bin/python3 /app/ip-masking/rotation.py
directory=/app/ip-masking
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/ip-rotation.err.log
stdout_logfile=/var/log/supervisor/ip-rotation.out.log
user=root
environment=PYTHONPATH="/app/ip-masking"

[program:security-scanner]
command=/usr/bin/python3 /app/monitoring/security_scanner.py
directory=/app/monitoring
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/security-scanner.err.log
stdout_logfile=/var/log/supervisor/security-scanner.out.log
user=root
environment=PYTHONPATH="/app/monitoring"

[program:log-analyzer]
command=/usr/bin/python3 /app/monitoring/log_analyzer.py
directory=/app/monitoring
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/log-analyzer.err.log
stdout_logfile=/var/log/supervisor/log-analyzer.out.log
user=root
environment=PYTHONPATH="/app/monitoring"

[program:telegram-bot]
command=/usr/bin/python3 /app/monitoring/telegram-bot.py
directory=/app/monitoring
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/telegram-bot.err.log
stdout_logfile=/var/log/supervisor/telegram-bot.out.log
user=root
environment=PYTHONPATH="/app/monitoring"

[program:backup-service]
command=/bin/sh -c 'while true; do sleep 3600; /app/scripts/backup.sh; done'
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/backup.err.log
stdout_logfile=/var/log/supervisor/backup.out.log
user=root

[program:health-check]
command=/bin/sh -c 'while true; do sleep 300; /app/scripts/health_check.sh; done'
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/health-check.err.log
stdout_logfile=/var/log/supervisor/health-check.out.log
user=root

[program:log-rotation]
command=/bin/sh -c 'while true; do sleep 86400; /app/scripts/log_rotation.sh; done'
autostart=true
autorestart=true
stderr_logfile=/var/log/supervisor/log-rotation.err.log
stdout_logfile=/var/log/supervisor/log-rotation.out.log
user=root




